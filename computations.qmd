---
title: "Quarto Computations"
author: "Gardenia in blossom"
date: "`r Sys.Date()`"
highlight-style: pygments
toc: true
execute:
  echo: false
format: 
  pdf:
    geometry: 
      - top = 30mm
      - left = 30mm
    code-line-numbers: true # 给代码添加行号显示
    documentclass: ctexart
    latex-engine: xelatex
---

This dataset contains a subset of the fuel economy data from the EPA. Specifically, we use the `mpg` dataset from the **ggplot2** package.

```{r}
#| label: load-packages
#| echo: true

library(ggplot2)
```

@fig-scatterplot shows a positive, strong, and linear relationship between the city and highway mileage of these cars. Additionally, mileage is higher for cars with fewer cylinders.

```{r}
#| label: fig-scatterplot
#| fig-cap: "city and highway mileage for 38 popular models of cars."
#| fig-alt: "scatterplot of city vs. highway mileage for cars, where points are colored by the number of cylinders. The plot dispalys a positive, linear, and strong relationship between city and highway mileage, and mileage increases as the number cylinders decreases."
#| fig-width: 6
#| fig-height: 3.5
#| echo: true

ggplot(mpg, aes(x = hwy, y = cty, color = cyl)) +
  geom_point(alpha = 0.5, size = 2) +
  scale_color_viridis_c() +
  theme_minimal()
```

The plots in @fig-mpg show the relationship between city and highway mileage for 38 popular models of cars. In @fig-mpg-1 the points are colored by the number of cylinders while in @fig-mpg-2 the points are colored by engine displacement.

```{r}
#| label: fig-mpg
#| fig-cap: "City and highway mileage for 38 popular models of cars."
#| fig-subcap:
#|   - "Color by number of cylinders"
#|   - "Color by engine displacement, in liters"
#| layout-ncol: 2
#| column: page
#| echo: true

ggplot(mpg, aes(x = hwy, y = cty, color = cyl)) +
  geom_point(alpha = 1, size = 2) + # alpha是设置透明度
  scale_color_viridis_c() + 
# 用于映射连续型（continuous）变量到颜色
# viridis 包提供了一些色盲友好的调色板
# 后缀 _c 表示连续型变量
# option 参数指定调色板的具体样式，E是其中一种
  theme_minimal() +
  labs(title = "Color by number of cylinders",
       x = "Highway miles per gallon",
       y = "City miles per gallon",
       color = "Number of cylinders")

ggplot(mpg, aes(x = hwy, y = cty, color = displ)) +
  geom_point(alpha = 0.5, size = 2) +
  scale_color_viridis_c(option = "E") +
  theme_minimal()
```

```{r}
#| echo: false

mean_cty <- round(mean(mpg$cty), 2)
mean_hwy <- round(mean(mpg$hwy), 2)
```

The average city mileage of the cars in our data is `{r} mean_cty` and the average highway mileage is `{r} mean_hwy`. 

